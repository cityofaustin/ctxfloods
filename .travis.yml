language: node_js
node_js:
- 8
addons:
  postgresql: 9.5
  apt:
    packages:
    - postgresql-9.5-postgis-2.3
services:
- postgresql
before_script: yarn;
script: yarn test && yarn build;
deploy:
  provider: s3
  access_key_id: "$AWS_ACCESS_KEY_ID"
  secret_access_key: "$AWS_SECRET_ACCESS_KEY"
  bucket: "$S3_BUCKET"
  skip_cleanup: true
  local_dir: build
  acl: public_read
  on:
    all_branches: true
    condition: "$AWS_ACCESS_KEY_ID"
env:
  global:
  - secure: vSF09Kh8YnLsEeQ+e8kj92MlOsFoJyld0Iv130Hjhm2ECV0x3hF6dS4BJ2NR8DSj4nGbIHZacOWi8AdrX2dlXPXhiSBpqIXIp4lfSdMiC4a/V+hwLWpVwsOV6sCM9st6Ax+y54BxhJYDjKiSZ9anMqyLFFP73uLZrfbEN4GFawP22tGXi4UpR1XOclSBMwHvVvh/qmYm+J+aq0J3zydddNqkoPxNsuymU2FmwJew6SSfbrKJWaHmBgWF3T0EXBuAf6haDk2NMvxJNWw43ezp/PEHkNadNcu4RsMus0wgmhbw1he+obQceLF+Vl5iIjncZI+HkiV5Nf5nq0ONSCQc578C6q1ZjFJ4YWCr5fjrBbdryPg4QfggsRoPpfst14gYrwgvZw7DFinLQhlE87rUlBrY6d0eg1iECu5oyyWXQS4VHvG8S3J489HGuTz1GvcWdlgAnbGw6/QV7qW9B3vulIdew81g8zLkzc5ohm8bHHIaI058IYyTgYAIW5SytJ3bUYtcJtjUmB8ErvxlC98glmk0nbAhEnkUUo5DD+v7uK8XLgWx/WYPmWBJglLvP5JW/nrgbUfBtEFqiSuPLBZESOGIG8t3WkC4SkmRGlfLYmNLt/HRDzQIqid2iW7pAFoVLwtVmMfRJW7J1xVa3CXCosWKxM+hn3ivv6GitoXTIrE=
  - secure: zJfVb0RqTuFRkkC6XBg69fDhOleBH46Rw3r8csKXSBbB78bx6vK1K0vLtUy+i5vMQruePJzFHC87Zvh/ygEIatO3Aau50iM3xif+0uvPPEh88QZXDgVn81Br47cTPdVNN4WbGibw2MSVUVFcnRrE9+GHO1sElcpnuz6kVC3prFSBrso3dWAggP7TjKKsMokP4S7hLDCXDyYbhoDogtyzNkrodr4o1IhQfHS+YR+T3IN/zBjKaKfgwb+6Sl1HObdyyUWoJfmM+H9gSC7zOoDYdA7mSx3Mw0raQdea1EdO+IWoe0PcX2NQ5hoTo+9xw3S3R7lo9lOxiKGLllHUCts51kveo8FXGRIB7BAMDNdINQlHqLgc3RmR5MRYSck2UQCd2bzRwpWPiO4G9FsKQgyIg71Juk/5Ls9QHxBtnipsMxe5XbXIfKpc4B0sKESof+vmF8N9H86oijgWR82WXQs2CV1jVujTMozvNKfICPxEDSMXknTNzxcCnimuzHuTE+FePapH0l/yvdhs9icJFoJL8v0Vmc9kbuA3WoedSUOrUu01XT0mbc4uduIa4mi/7OoweHcTIWTEGXK33CoZZihp3dTmqy6es6EsrPKeY4xKxOCn5tJozr5jXhroaDdHE0R168ywzog2/cuVsSn2nVaangVBIjqLJ5MTXYZptRbEB1g=
  - CURRENT_FLOODS_BRANCH_NAME=master
  - S3_BUCKET=ctxfloods-frontend-master
  - REACT_APP_BACKEND_URL=https://fzd0rh62c5.execute-api.us-east-1.amazonaws.com/dev
